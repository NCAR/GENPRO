ECHO,OFF.
*
* GPTP2MS JOB -- used to stage tapes from MT to MS
*   -- this deck is set up via the interface provided by GPTP2MS EXEC
*
*
* Usage TPSTAGE,<user>,<tapeno>,<projno>,<fltno>,<year>,[<number files>].
*
SET,G0=0.
PROC.
TPSTAGE,USER,TAPENO,PROJNO,FLTNO,YEAR,INP=MT:XB,NFILES=1:1.
IF (G0.EQ.0)
DISPOSE,DN=$OUT,DEFER,MF=NG,DC=ST,^
TEXT='HOST=spock.atd.ucar.edu,FLNM=tp2ms.&PROJNO_log'.
SET,G0=1.         ...flag to defer batch output only once
ENDIF.
*.
*. &PROJNO-&FLTNO
*. ACQUIRE 1/2 INCH TAPE &TAPENO
*.
IF ('&INP' .EQ. 'MT')
MIMPORT (NAME=/RAF/&YEAR/&PROJNO/&FLTNO/&TAPENO BLKSIZE=50000 ^
DEN=1600 VSN=&TAPENO EOTP=IGNORE ERRORS=99 FILES=&NFILES PASSWD=,RAFDMG ^
RETPD=4095 FORMAT=BI VIRTUAL=CTRAFDMG DEVICE=MT RETRY=YES)
ELSE.
MIMPORT (NAME=/RAF/&YEAR/&PROJNO/&FLTNO/&TAPENO  ^
DEN=6250 VSN=&TAPENO FILES=&NFILES PASSWD=,RAFDMG ^
RETPD=4095 FORMAT=BI VIRTUAL=CTRAFDMG DEVICE=EX RETRY=YES)
ENDIF.
*.
ENDPROC.
ECHO,ON.
